y_max = quantile(c(density_raw_zero$y, density_induced_zero$y, density_kept_values$y), 0.99) * 1.02
x_max = quantile(c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]]), 0.99) * 1.02
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
density_raw_zero = density(data_list[[jj]][[ii]][["top_raw_zero_imputation"]][data_list[[jj]][[ii]][["top_raw_zero_imputation"]] <= quantile(data_list[[jj]][[ii]][["top_raw_zero_imputation"]], 0.99)])
density_induced_zero = density(data_list[[jj]][[ii]][["top_induced_zero_imputation"]][data_list[[jj]][[ii]][["top_induced_zero_imputation"]] <= quantile(data_list[[jj]][[ii]][["top_induced_zero_imputation"]], 0.99)])
y_max = quantile(c(density_raw_zero$y, density_induced_zero$y, density_kept_values$y), 0.99) * 1.02
x_max = quantile(c(data_list[[jj]][[ii]][["top_raw_zero_imputation"]], data_list[[jj]][[ii]][["top_induced_zero_imputation"]]), 0.99) * 1.02
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - Top 1000 genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
x_max = quantile(c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]]), 0.99) * 1.1
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
bw
x_max
summary(c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]]))
sum(c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]]) > 0)
length(c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]]))
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
expressed_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(expressed_values[expressed_values > 0], 0.99) * 1.02
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
quantile(expressed_values[expressed_values > 0], 0.95) * 1.1
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
expressed_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(expressed_values[expressed_values > 0], 0.95) * 1.1
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
quantile(expressed_values[expressed_values > 0], 0.95)
quantile(expressed_values[expressed_values > 0], 0.9) * 3
quantile(expressed_values[expressed_values > 0], 0.75) * 3
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
expressed_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(expressed_values[expressed_values > 0], 0.75) * 5
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
expressed_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(expressed_values[expressed_values > 0], 0.75) * 5
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
expressed_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(expressed_values[expressed_values > 0], 0.99) * 1.02
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.01], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.01], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
expressed_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(expressed_values[expressed_values > 0], 0.95) * 2
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.01], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.01], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
expressed_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(expressed_values[expressed_values > 0], 0.75) * 5
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
expressed_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(expressed_values[expressed_values > 0], 0.9) * 3
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
all_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max_candidate = quantile(all_values, 0.99) * 1.5
x_max_alternative = quantile(all_values[all_values > 0], 0.75) * 5
if(x_max_candidate == 0){
x_max = x_max_alternative
}else{
x_max = x_max_candidate
}
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
all_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max_candidate = quantile(all_values, 0.95) * 2
x_max_alternative = quantile(all_values[all_values > 0], 0.75) * 3
if(x_max_candidate == 0){
x_max = x_max_alternative
}else{
x_max = x_max_candidate
}
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y)) * 1.01
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.1)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
all_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max_candidate = quantile(all_values, 0.99) * 1.5
x_max_alternative = quantile(all_values[all_values > 0], 0.75) * 5
if(x_max_candidate == 0){
x_max = x_max_alternative
}else{
x_max = x_max_candidate
}
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y))
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
all_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max_candidate = quantile(all_values, 0.99) * 1.5
x_max_alternative = quantile(all_values[all_values > 0], 0.75) * 5
if(x_max_candidate == 0){
x_max = x_max_alternative
}else{
x_max = x_max_candidate
}
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["top_raw_zero_imputation"]][data_list[[jj]][[ii]][["top_raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["top_induced_zero_imputation"]][data_list[[jj]][[ii]][["top_induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y))
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - Top 1000 genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
all_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max_candidate = quantile(all_values, 0.99) * 1.5
x_max_alternative = quantile(all_values[all_values > 0], 0.75) * 5
if(x_max_candidate == 0){
x_max = x_max_alternative
}else{
x_max = x_max_candidate
}
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y))
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir="E:/DISC/reproducibility")
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
x_max = max(c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]]))
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]])
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]])
y_max = max(c(density_raw_zero$y, density_induced_zero$y))
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
all_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max = quantile(all_values, 0.99)
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= x_max])
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= x_max])
y_max = max(c(density_raw_zero$y, density_induced_zero$y))
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
all_values = c(data_list[[jj]][[ii]][["raw_zero_imputation"]], data_list[[jj]][[ii]][["induced_zero_imputation"]])
x_max_candidate = quantile(all_values, 0.99) * 1.5
x_max_alternative = quantile(all_values[all_values > 0], 0.75) * 5
if(x_max_candidate == 0){
x_max = x_max_alternative
}else{
x_max = x_max_candidate
}
bw = x_max / 512
density_raw_zero = density(data_list[[jj]][[ii]][["top_raw_zero_imputation"]][data_list[[jj]][[ii]][["top_raw_zero_imputation"]] <= x_max * 1.1], bw = bw)
density_induced_zero = density(data_list[[jj]][[ii]][["top_induced_zero_imputation"]][data_list[[jj]][[ii]][["top_induced_zero_imputation"]] <= x_max * 1.1], bw = bw)
y_max = max(c(density_raw_zero$y, density_induced_zero$y))
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - Top 1000 genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= quantile(data_list[[jj]][[ii]][["raw_zero_imputation"]], 0.99)])
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= quantile(data_list[[jj]][[ii]][["induced_zero_imputation"]], 0.99)])
y_max = max(c(density_raw_zero$y, density_induced_zero$y))
x_max = max(c(density_raw_zero$x, density_induced_zero$x))
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
density_raw_zero = density(data_list[[jj]][[ii]][["raw_zero_imputation"]][data_list[[jj]][[ii]][["raw_zero_imputation"]] <= quantile(data_list[[jj]][[ii]][["raw_zero_imputation"]], 0.99)])
density_induced_zero = density(data_list[[jj]][[ii]][["induced_zero_imputation"]][data_list[[jj]][[ii]][["induced_zero_imputation"]] <= quantile(data_list[[jj]][[ii]][["induced_zero_imputation"]], 0.99)])
x_max = max(c(density_raw_zero$x, density_induced_zero$x))
y_max = quantile(c(density_raw_zero$y, density_induced_zero$y), 0.99) * 1.02
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - All genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
par(mfrow = c(1, 2), mar = c(5, 0, 0.5, 0), oma = c(0, 5, 6, 2), mgp = c(3.5, 1, 0), cex.axis = 1.1, cex.lab = 1.5, font.lab = 2, cex.main = 1.5)
mtext_position = seq(from = 0, to = 1, by = 1 / length(used_datasets) / 2)[seq(length(used_datasets)) * 2]
names(mtext_position) = used_datasets
for(ii in method_names){
for(jj in used_datasets){
density_raw_zero = density(data_list[[jj]][[ii]][["top_raw_zero_imputation"]][data_list[[jj]][[ii]][["top_raw_zero_imputation"]] <= quantile(data_list[[jj]][[ii]][["top_raw_zero_imputation"]], 0.99)])
density_induced_zero = density(data_list[[jj]][[ii]][["top_induced_zero_imputation"]][data_list[[jj]][[ii]][["top_induced_zero_imputation"]] <= quantile(data_list[[jj]][[ii]][["top_induced_zero_imputation"]], 0.99)])
x_max = max(c(density_raw_zero$x, density_induced_zero$x))
y_max = quantile(c(density_raw_zero$y, density_induced_zero$y), 0.99) * 1.02
plot(0, type = "n", xlim = c(-min(c(1, x_max * 0.05)), x_max), ylim = c(0, y_max), axes = FALSE, ann = FALSE, frame.plot = TRUE)
lines(density_raw_zero, col = "black", lwd = 2)
lines(density_induced_zero, col = "red", lwd = 2)
axis(1)
mtext(jj, outer = TRUE, cex = 1.2, font = 2, line = 0.5, at = mtext_position[jj])
cat("Finish: ", ii, " - ", jj, "\n")
}
mtext(paste0(ii, " - Top 1000 genes"), outer = TRUE, cex = 1.4, font = 2, line = 3)
legend("topright", c("Raw zero", "Sampled zero"), lty = 1, col = c("black", "red"), lwd = 2)
cat("Finish: ", ii, "\n")
}
fft(10, inverse = FALSE)
fft(10)
